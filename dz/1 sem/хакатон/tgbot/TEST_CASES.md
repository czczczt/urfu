# Тестовые кейсы для проверки исправлений бота

## Проблема 1: Распознавание "в центре" / "на краю"

### Тест 1.1: Распознавание центра
**Запрос:** "Екатеринбург, в центре"
**Ожидаемый результат:** 
- Город: Екатеринбург
- Район: Ленинский (центральный район Екатеринбурга)

### Тест 1.2: Распознавание "на краю"
**Запрос:** "Екатеринбург, на краю города"
**Ожидаемый результат:** 
- Город: Екатеринбург
- Район: null или окраинные районы
- Исключенные районы: ["Ленинский"] (центр должен быть исключен)

### Тест 1.3: Распознавание окраин
**Запрос:** "Москва, не рассматриваю окраины"
**Ожидаемый результат:** 
- Город: Москва
- Исключенные районы должны содержать окраинные районы

---

## Проблема 2: Сохранение критериев при уточнении

### Тест 2.1: Базовый тест сохранения города
**Шаг 1:** "Екатеринбург, бюджет 200000"
- Ожидаемый результат: Город = Екатеринбург, Бюджет = 200000

**Шаг 2:** Нажать "Уточнить критерии", написать "площадь 100 метров"
- Ожидаемый результат: Город = Екатеринбург (сохранен!), Бюджет = 200000 (сохранен!), Площадь = 80-120

### Тест 2.2: Уточнение с добавлением района
**Шаг 1:** "Екатеринбург, бюджет 150000"
- Ожидаемый результат: Город = Екатеринбург, Бюджет = 150000

**Шаг 2:** Нажать "Уточнить критерии", написать "в центре"
- Ожидаемый результат: Город = Екатеринбург (сохранен!), Бюджет = 150000 (сохранен!), Район = Ленинский

### Тест 2.3: Уточнение с изменением бюджета
**Шаг 1:** "Екатеринбург, в центре, бюджет 200000"
- Ожидаемый результат: Город = Екатеринбург, Район = Ленинский, Бюджет = 200000

**Шаг 2:** Нажать "Уточнить критерии", написать "бюджет 300000"
- Ожидаемый результат: Город = Екатеринбург (сохранен!), Район = Ленинский (сохранен!), Бюджет = 300000 (обновлен!)

### Тест 2.4: Множественное уточнение
**Шаг 1:** "Екатеринбург"
- Ожидаемый результат: Город = Екатеринбург

**Шаг 2:** Уточнить: "бюджет 200000"
- Ожидаемый результат: Город = Екатеринбург (сохранен!), Бюджет = 200000

**Шаг 3:** Уточнить: "в центре"
- Ожидаемый результат: Город = Екатеринбург (сохранен!), Бюджет = 200000 (сохранен!), Район = Ленинский

**Шаг 4:** Уточнить: "площадь 50 метров"
- Ожидаемый результат: Город = Екатеринбург (сохранен!), Бюджет = 200000 (сохранен!), Район = Ленинский (сохранен!), Площадь = 40-60

---

## Как тестировать

1. Запустите бота в Telegram
2. Начните с команды /start
3. Для каждого теста:
   - Следуйте шагам теста
   - Проверьте, что бот правильно распознал критерии (смотрите на "Распознанные критерии")
   - Убедитесь, что при уточнении старые критерии сохраняются
   - Проверьте, что фильтрация работает корректно

---

## Результаты тестирования

### Тест 1.1: ✅ / ❌
### Тест 1.2: ✅ / ❌
### Тест 1.3: ✅ / ❌
### Тест 2.1: ✅ / ❌
### Тест 2.2: ✅ / ❌
### Тест 2.3: ✅ / ❌
### Тест 2.4: ✅ / ❌

---

## Примечания по тестированию

- После каждого неудачного теста используйте /start для сброса
- Обращайте внимание на консольный вывод бота - там видны логи распознавания
- Если район не распознается, проверьте файл ekaterinburg_cian.csv - там должны быть адреса с правильными районами
