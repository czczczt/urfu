в коде разобрался, могу ответить на вопросы
